---
import App from '@layouts/App.astro';

import { SITE_TITLE, SITE_DESCRIPTION } from '@consts';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const highlightedPosts = posts.slice(0, 3);
---

<App title={SITE_TITLE} description={SITE_DESCRIPTION} pubDate={new Date()}>
    <section>
        <h2>Highlighted Posts</h2>

        <div id="highlighted-posts">
            {
                highlightedPosts.map((post) => {
                    return (
                        <a href={`/blog/${post.slug}/`}>
                            <article>
                                <img src={post.data.heroImage} />{' '}
                                <div>
                                    <h2>{post.data.title}</h2>
                                    <p>{post.data.description}</p>
                                </div>
                            </article>
                        </a>
                    );
                })
            }
        </div>
    </section>

    <section>
        <h2>Test</h2>
    </section>
</App>

<style>
    main section {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    main section article {
        display: flex;
        gap: 1rem;
        align-items: center;
    }

    main section article img {
        height: 150px;
        width: 150px;
        object-fit: cover;
        border-radius: 12px;
    }

    main section article div {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
</style>
